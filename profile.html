<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
</head>
<body>
    <!--Display Username-->
    <h3 id="username"></h3>

    <!--Navigation to click between Home, Profile, and Chat-->
    <nav>
        <button onclick="window.location.href='profile.html'">Profile</button>
        <button onclick="window.location.href='home.html'">Home</button>
        <button onclick="window.location.href='chat.html'">Chat</button> 
    </nav>

    <!--Display bio-->
    <h6 id="bio"></h6>
    <!--Display available days-->
    <h6 id="availableDays"></h6>
    <!-- Display pet type and gender -->
    <h6 id="genderPetType"></h6>
    <!-- Display pet's age -->
    <h6 id="petAge"></h6>
    <!-- Display size -->
    <h6 id="size"></h6>
    <!-- Display vaccination status -->
    <h6 id="vaccinationStatus"></h6>
    <!-- Display neutered/spayed -->
    <h6 id="neuteredSpayed"></h6>
    <!--Button to edit profile-->
    <button onclick="window.location.href='configureProfile.html'">Edit Profile</button>
    <!--Button to sign out-->
    <button type="button" id="signoutbtn">Sign Out</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js";
        import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-database.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCE4N3-_icVHFbWLWI9rqO_E-uXwqB67rk",
            authDomain: "pawmates-a1757.firebaseapp.com",
            databaseURL: "https://pawmates-a1757-default-rtdb.firebaseio.com",
            projectId: "pawmates-a1757",
            storageBucket: "pawmates-a1757.appspot.com",
            messagingSenderId: "212632097126",
            appId: "1:212632097126:web:bb4518a57e31549c2178a7"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase();
        const auth = getAuth(app);

        let UserId = document.getElementById('username');
        let BioId = document.getElementById('bio');
        const AvailableDaysId = document.getElementById('availableDays');
        let TypeGenderId = document.getElementById('genderPetType');
        let PetAgeId = document.getElementById('petAge');
        let SizeId = document.getElementById('size');
        let VaccId = document.getElementById('vaccinationStatus');
        let NeuteredSpayedId = document.getElementById('neuteredSpayed');
        let SignoutButton = document.getElementById('signoutbtn');

        const Signout = () => {
            auth.signOut().then(() => {
                window.location.href = 'login.html';
            }).catch((error) => {
                console.error('Sign Out Error', error);
            });
        };

        const getUserInfo = () => {
    const user = auth.currentUser;
    if (user) {
        const userRef = ref(db, `Users/${user.uid}`);
        get(userRef).then((snapshot) => {
            if (snapshot.exists()) {
                const userData = snapshot.val();
                UserId.innerText = `${userData.Username}'s profile ✮⋆˙`; // Display username
                BioId.innerText = `Bio: ${userData.Bio || 'No bio available'}`; // Display bio

                // Display available days if they exist
                if (userData.AvailableDays && userData.AvailableDays.length > 0) {
                    AvailableDaysId.innerText = `Available Days: ${userData.AvailableDays.join(', ')}`;
                } else {
                    AvailableDaysId.innerText = 'No available days selected';
                }

                // Display pet type and gender
                TypeGenderId.innerText = `Pet Type: ${userData.PetType || 'Not specified'} | Gender: ${userData.Gender}`;

                PetAgeId.innerText = `Pet's Age: ${userData.PetAge} ${userData.AgeUnit || 'Not specified'}`;

                // Display pet's size, vaccination status, and neutered/spayed status
                SizeId.innerText = `Size: ${userData.Size || 'Not specified'}`;
                VaccId.innerText = `Vaccinated: ${userData.Vaccinated || 'Not specified'}`;
                NeuteredSpayedId.innerText = `Neutered/Spayed: ${userData.NeuteredSpayed || 'Not specified'}`;
            } else {
                console.log('No data available');
            }
        }).catch((error) => {
            console.error('Error getting user info', error);
        });
    }
};


        //Event listener for sign out button
        SignoutButton.addEventListener('click', Signout);

        onAuthStateChanged(auth, (user) => {
            if (user) {
                getUserInfo();
            } else {
                window.location.href = 'login.html';
            }
        });
    </script>
</body>
</html>
