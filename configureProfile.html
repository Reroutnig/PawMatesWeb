<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editing Profile...</title>
</head>
<body>
    <div>
        <form id="ProfileForm">
            <h3>Editing Profile...</h3>
            <input type="text" placeholder="Bio" id="bioInp"> <!--Text area to enter bio-->
            <button type="submit" id="saveProfBtn">Save</button> <!--Button to save changes-->
            <button type="button" id="cancelBtn">Cancel</button> <!--Button to cancel changes-->
        </form>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js";
        import { getDatabase, ref, set} from "https://www.gstatic.com/firebasejs/10.5.2/firebase-database.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCE4N3-_icVHFbWLWI9rqO_E-uXwqB67rk",
            authDomain: "pawmates-a1757.firebaseapp.com",
            databaseURL: "https://pawmates-a1757-default-rtdb.firebaseio.com",
            projectId: "pawmates-a1757",
            storageBucket: "pawmates-a1757.appspot.com",
            messagingSenderId: "212632097126",
            appId: "1:212632097126:web:bb4518a57e31549c2178a7"
        };

        //Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase();
        const auth = getAuth(app);
      
        let bioInp = document.getElementById('bioInp');
        let ProfileForm = document.getElementById('ProfileForm');

        const SaveBio = (evt) => {
            evt.preventDefault();

            //Get the currently logged-in user
            const user = auth.currentUser;

            if (user) {
                const userRef = ref(db, 'Users/' + user.uid + '/Bio');
                set(userRef, bioInp.value)
                    .then(() => {
                        window.location.href = 'profile.html'; //Redirect to the profile page
                    })
                    .catch((error) => {
                        alert(error.message);
                    });
            } else {
                //User not logged in, handle this scenario accordingly
                console.log('User not logged in.');
            }
        };

         //Function to handle canceling edits
         const CancelEdit = () => {
            window.location.href = 'profile.html'; //Redirect to the profile page without saving changes
        };

        //Add event listener to the cancel button
        const cancelBtn = document.getElementById('cancelBtn');
        cancelBtn.addEventListener('click', CancelEdit);

        //Add event listener to the profile form
        ProfileForm.addEventListener('submit', SaveBio);
    </script>
    </body>
</html>